<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute and plot an item correlation matrix — plot_corr • ShinyItemAnalysis</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute and plot an item correlation matrix — plot_corr" />
<meta property="og:description" content="Computes and visualizes an item correlation matrix (also known
  as a heatmap), offering several correlation &quot;types&quot; and optional clustering
  (with possible cluster outlining). The function relies on
  ggplot2 package, providing a high customisability using &quot;the
  grammar of graphics&quot; (see the examples below)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ShinyItemAnalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/patriciamar/ShinyItemAnalysis/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute and plot an item correlation matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/patriciamar/ShinyItemAnalysis/blob/master/R/plot_corr.R'><code>R/plot_corr.R</code></a></small>
    <div class="hidden name"><code>plot_corr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes and visualizes an item correlation matrix (also known
  as a heatmap), offering several correlation "types" and optional clustering
  (with possible cluster outlining). The function relies on
  <code>ggplot2</code> package, providing a high customisability using "the
  grammar of graphics" (see the examples below).</p>
    </div>

    <pre class="usage"><span class='fu'>plot_corr</span><span class='op'>(</span>
  <span class='va'>Data</span>,
  cor <span class='op'>=</span> <span class='st'>"pearson"</span>,
  clust_method <span class='op'>=</span> <span class='st'>"none"</span>,
  n_clust <span class='op'>=</span> <span class='fl'>0</span>,
  shape <span class='op'>=</span> <span class='st'>"circle"</span>,
  labels <span class='op'>=</span> <span class='cn'>FALSE</span>,
  labels_size <span class='op'>=</span> <span class='fl'>3</span>,
  line_size <span class='op'>=</span> <span class='fl'>0.5</span>,
  line_col <span class='op'>=</span> <span class='st'>"black"</span>,
  line_alpha <span class='op'>=</span> <span class='fl'>1</span>,
  fill <span class='op'>=</span> <span class='cn'>NA</span>,
  fill_alpha <span class='op'>=</span> <span class='cn'>NA</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Data</th>
      <td><p><code>matrix</code>, <code>data.frame</code> or <code>tibble</code>: either a
<code>data.frame</code> with scored items (as columns, one observation per row),
or a correlation matrix.</p></td>
    </tr>
    <tr>
      <th>cor</th>
      <td><p>character: correlation "type" used to correlation matrix
computation; available options are <code>"poly"</code>, <code>"tetra"</code>,
<code>"pearson"</code>, <code>"spearman"</code>, or <code>"none"</code> (in case you provide
the correlation matrix directly instead). You can use an unambiguous
abbreviation.</p></td>
    </tr>
    <tr>
      <th>clust_method</th>
      <td><p>character: optional clustering method, available options
are: <code>"ward.D"</code>, <code>"ward.D2"</code>, <code>"single"</code>, <code>"complete"</code>,
<code>"average"</code> (= UPGMA), <code>"mcquitty"</code> (= WPGMA), <code>"median"</code> (=
WPGMC), <code>"centroid"</code> (= UPGMC) or <code>"none"</code> (clustering disabled).
See <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> for a detailed description of available options.</p></td>
    </tr>
    <tr>
      <th>n_clust</th>
      <td><p>integer: the number of clusters you want to be outlined. When
set to zero, clustering is disabled, ignoring the <code>clust_method</code>
argument.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>character: tile appearance; either <code>circle</code> (default) to
map the correlation coefficient to circle size and color, or <code>square</code>
to draw square-shaped tiles with only shade denoting the coefficient
magnitude. You can use an unambiguous abbreviation of the two.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>logical: when <code>TRUE</code>, the correlation coefficients are
plotted onto tiles.</p></td>
    </tr>
    <tr>
      <th>labels_size</th>
      <td><p>numeric: label size in points (pts).</p></td>
    </tr>
    <tr>
      <th>line_size</th>
      <td><p>numeric: cluster outline width.</p></td>
    </tr>
    <tr>
      <th>line_col</th>
      <td><p>character: color of the outline, either a HEX code (e.g.
"#123456"), or one of <code>R</code>'s standard colors (see the
<code><a href='https://rdrr.io/r/grDevices/colors.html'>colors</a></code>).</p></td>
    </tr>
    <tr>
      <th>line_alpha</th>
      <td><p>numeric 0-1: the opacity of the outline.</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>character: the color used to fill the outlined clusters.</p></td>
    </tr>
    <tr>
      <th>fill_alpha</th>
      <td><p>numeric 0-1: the opacity of the fill color.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='https://rdrr.io/pkg/psych/man/tetrachor.html'>psych::polychoric</a></code></p><dl>
    <dt><code>correct</code></dt><dd><p>Correction value to use to correct for continuity in the case of zero entry cell for tetrachoric, polychoric, polybi, and mixed.cor.  See the examples for the effect of correcting versus not correcting for continuity.</p></dd>
    <dt><code>smooth</code></dt><dd><p>if TRUE and if the tetrachoric/polychoric matrix is not positive definite, then apply a simple smoothing algorithm using cor.smooth</p></dd>
    <dt><code>global</code></dt><dd><p>When finding pairwise correlations, should we use the global values of the tau parameter (which is somewhat faster), or the local values (global=FALSE)?  The local option is equivalent to the polycor solution, or to doing one correlation at a time. global=TRUE borrows information for one item pair from the other pairs using those item's frequencies.   This will make a difference in the presence of lots of missing data. With very small sample sizes with global=FALSE and correct=TRUE, the function will fail (for as yet underdetermined reasons.</p></dd>
    <dt><code>polycor</code></dt><dd><p>A no longer used option, kept to stop other packages from breaking.</p></dd>
    <dt><code>weight</code></dt><dd><p>A vector of length of the number of observations that specifies the weights to apply to each case.  The NULL case is equivalent of weights of 1 for all cases.</p></dd>
    <dt><code>std.err</code></dt><dd><p>std.err=FALSE does not report the standard errors (faster)  deprecated</p></dd>
    <dt><code>progress</code></dt><dd><p>Show the progress bar (if  not doing multicores)</p></dd>
    <dt><code>ML</code></dt><dd><p>ML=FALSE  do a quick two step procedure, ML=TRUE, do longer maximum likelihood --- very slow! Deprecated</p></dd>
    <dt><code>delete</code></dt><dd><p>Cases with no variance are deleted with a warning before proceeding.</p></dd>
    <dt><code>max.cat</code></dt><dd><p>The maximum number of categories to bother with for polychoric.</p></dd>
  
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>ggplot</code> and/or <code>gg</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Correlation heatmap displays selected type of correlations between
  items.The color of tiles indicates how much and in which way the items are
  correlated - red color means positive correlation and blue color means
  negative correlation. Correlation heatmap can be reordered using
  hierarchical clustering method specified with <code>clust_method</code> argument.
  When the desired number of clusters (argument <code>n_clust</code>) is not zero
  and some clustering is demanded, the rectangles outlining the found
  clusters are drawn.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jan Netik <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href='mailto:netik@cs.cas.cz'>netik@cs.cas.cz</a></p>
<p>Patricia Martinkova <br />
Institute of Computer Science of the Czech Academy of Sciences <br />
<a href='mailto:martinkova@cs.cas.cz'>martinkova@cs.cas.cz</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># use first 20 columns from HCI dataset (the remainder are not items)</span>
<span class='va'>HCI</span> <span class='op'>&lt;-</span> <span class='va'>HCI</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span><span class='op'>]</span>

<span class='co'># use Pearson product-moment correlation coefficient for matrix computation</span>
<span class='fu'>plot_corr</span><span class='op'>(</span><span class='va'>HCI</span>, cor <span class='op'>=</span> <span class='st'>"pearson"</span><span class='op'>)</span>
</div><div class='img'><img src='plot_corr-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># use tetrachoric correlation and reorder the resulting heatmap</span>
<span class='co'># using Ward's method</span>
<span class='va'>HCI</span> <span class='op'>%&gt;%</span> <span class='fu'>plot_corr</span><span class='op'>(</span>cor <span class='op'>=</span> <span class='st'>"tetra"</span>, clust_method <span class='op'>=</span> <span class='st'>"ward.D"</span><span class='op'>)</span>

<span class='co'># outline 3 Ward's clusters with bold yellow line and add labels</span>
<span class='va'>HCI</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_corr</span><span class='op'>(</span>
    n_clust <span class='op'>=</span> <span class='fl'>3</span>, clust_method <span class='op'>=</span> <span class='st'>"ward.D"</span>, line_col <span class='op'>=</span> <span class='st'>"yellow"</span>,
    line_size <span class='op'>=</span> <span class='fl'>1.5</span>, labels <span class='op'>=</span> <span class='cn'>TRUE</span>
  <span class='op'>)</span>

<span class='co'># add title and position the legend below the plot</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='va'>HCI</span> <span class='op'>%&gt;%</span> <span class='fu'>plot_corr</span><span class='op'>(</span>n_clust <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"HCI heatmap"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span>

<span class='co'># mimic the look of corrplot package</span>
<span class='fu'>plot_corr</span><span class='op'>(</span><span class='va'>HCI</span>, cor <span class='op'>=</span> <span class='st'>"poly"</span>, clust_method <span class='op'>=</span> <span class='st'>"complete"</span>, shape <span class='op'>=</span> <span class='st'>"sq"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient2</a></span><span class='op'>(</span>
    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.1</span>, <span class='fl'>1</span><span class='op'>)</span>,
    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.1</span>, <span class='fl'>1</span>, length.out <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
    guide <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_colourbar.html'>guide_colorbar</a></span><span class='op'>(</span>
      barheight <span class='op'>=</span> <span class='fl'>.8</span>, barwidth <span class='op'>=</span> <span class='fl'>.0275</span>,
      default.unit <span class='op'>=</span> <span class='st'>"npc"</span>,
      title <span class='op'>=</span> <span class='cn'>NULL</span>, frame.colour <span class='op'>=</span> <span class='st'>"black"</span>, ticks.colour <span class='op'>=</span> <span class='st'>"black"</span>
    <span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Patricia Martinkova, Adela Hladka, Jan Netik.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


